<?php
/**
* @file
* Code for eMindHub blocks feature.
*/

/**
 * Implements hook_block_info().
 */
function emh_blocks_block_info() {
  $blocks = array();

  $blocks["baseline"] = array(
    'info' => t("HP - Baseline"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -100,
    'status' => 1,
    'region' => 'header',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["business_question"] = array(
    'info' => t("HP - Business - Question"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -100,
    'status' => 1,
    'region' => 'sidebar_first',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["expert_question"] = array(
    'info' => t("HP - Expert - Question"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -100,
    'status' => 1,
    'region' => 'sidebar_second',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["business_you_are"] = array(
    'info' => t("HP - Business - You are"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -99,
    'status' => 1,
    'region' => 'sidebar_first',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["expert_you_are"] = array(
    'info' => t("HP - Expert - You are"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -99,
    'status' => 1,
    'region' => 'sidebar_second',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["business_why"] = array(
    'info' => t("HP - Business - Why"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -98,
    'status' => 1,
    'region' => 'sidebar_first',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );
  $blocks["expert_why"] = array(
    'info' => t("HP - Expert - Why"),
    'cache' => DRUPAL_CACHE_PER_ROLE,
    'weight' => -98,
    'status' => 1,
    'region' => 'sidebar_second',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'pages' => "<front>",
  );

  return $blocks;
}

/**
 * Implements hook_block_view().
 */
function emh_blocks_block_view($delta = '') {
  $block = array();

  switch ($delta) {
    case 'baseline':
    case 'business_question':
    case 'expert_question':
    case 'business_you_are':
    case 'expert_you_are':
    case 'business_why':
    case 'expert_why':
      $data = variable_get("emh_blocks_$delta", array('value' => '', 'format' => 'filtered_html'));
      $block = array(
        'subject' => '<none>',
        'content' => array(
          'text' => array(
            '#markup' => check_markup($data['value'], $data['format']),
          ),
        ),
      );
      break;
  }

  return $block;
}

/**
 * Implements hook_block_configure().
 */
function emh_blocks_block_configure($delta='') {
  $form = array();

  switch($delta) {
    case 'baseline':
    case 'business_question':
    case 'expert_question':
    case 'business_you_are':
    case 'expert_you_are':
    case 'business_why':
    case 'expert_why':
      $data = variable_get("emh_blocks_$delta", array('value' => '', 'format' => 'filtered_html'));
      $form['text'] = array(
        '#type' => 'text_format',
        '#title' => t('Block text'),
        '#default_value' => $data['value'],
        '#format' => $data['format'],
      );
      break;
  }

  return $form;
}

/**
 * Implements hook_block_save().
 */
function emh_blocks_block_save($delta = '', $edit = array()) {
  switch($delta) {
    case 'baseline':
    case 'business_question':
    case 'expert_question':
    case 'business_you_are':
    case 'expert_you_are':
    case 'business_why':
    case 'expert_why':
      variable_set("emh_blocks_block_$delta", $edit['text']);
      break;
  }
}
