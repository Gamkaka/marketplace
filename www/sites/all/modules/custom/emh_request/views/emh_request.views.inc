<?php

/**
 * @file
 * Views hooks implemented for the EMH Request module.
 */

/**
 * Implements hook_views_data().
 * @ingroup views
 */
function emh_request_views_data() {
  $data = array();

  // Pseudo-field on comment.
  $data['comment']['emh_answer'] = array(
    'group' => 'Comment',
    'real field' => 'cid',
    'help' => 'Answer',
    'title' => 'EMH Answer',
    'field' => array(
      'handler' => 'views_handler_field_emh_comment_answer',
    ),
  );

  // Pseudo-field on webform submissions.
  $data['webform_submissions']['emh_answer'] = array(
    'group' => t('Webform submissions'),
    'real field' => 'sid',
    'help' => 'Answer',
    'title' => 'EMH Answer',
    'field' => array(
      'handler' => 'views_handler_field_emh_webform_answer',
    ),
  );

  // Pseudo-field on webform submissions.
  $data['webform_submissions']['emh_submission_actions'] = array(
    'group' => t('Webform submissions'),
    'real field' => 'sid',
    'help' => 'Submission actions',
    'title' => 'EMH Submission actions',
    'field' => array(
      'handler' => 'views_handler_field_emh_webform_submission_actions',
    ),
  );

  // Pseudo-field on request submissions answers count.
  $data['node']['total_answers'] = array(
    'group' => t('Node'),
    'title' => 'EMH Total Answers',
    'field' => array(
      'handler' => 'views_handler_field_emh_request_answer_count',
    ),
  );

  $data['node']['request_status'] = array(
    'group' => t('Node'),
    'title' => 'EMH Request status',
    'field' => array(
      'handler' => 'views_handler_field_emh_request_status',
    ),
  );

  $data['node']['request_type'] = array(
    'group' => t('Node'),
    'title' => 'EMH Request type',
    'field' => array(
      'handler' => 'views_handler_field_emh_request_type',
    ),
  );

  return $data;
}

function emh_request_views_data_alter(&$data) {
  $data['webform_submissions']['is_draft']['field']['handler'] = 'emh_request_webform_handler_field_is_draft';
  $data['webform_submissions']['is_draft']['filter']['handler'] = 'emh_request_webform_handler_filter_is_draft';
}
